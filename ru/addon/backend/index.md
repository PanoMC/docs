# –ë—ç–∫–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (Kotlin)

## üöÄ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø–ª–∞–≥–∏–Ω–∞ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç
–ü–ª–∞–≥–∏–Ω—ã —Ä–∞—Å—à–∏—Ä—è—é—Ç –∫–ª–∞—Å—Å `PanoPlugin`. –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:
-   `applicationContext`: –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç DI Pano.
-   `pluginBeanContext`: –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –±–∏–Ω–∞–º–∏ –ø–ª–∞–≥–∏–Ω–∞.
-   `pluginGlobalBeanContext`: –î–µ–ª–∏—Ç –±–∏–Ω—ã –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏.

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π:**
```kotlin
@EventListener
class SetupEventHandler(private val plugin: YourPlugin): SetupEventListener {
    override suspend fun onSetupFinished() {
        if (plugin.pluginState == PluginState.STARTED) {
            plugin.startPlugin()
        }
    }
}
```

**–ú–µ—Ç–æ–¥—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –ø–ª–∞–≥–∏–Ω–∞:**
```kotlin
override suspend fun onStart() {
    if (!setupManager.isSetupDone()) {
        return // –ñ–¥–µ–º SetupEventHandler
    }
    startPlugin()
}

override suspend fun onUninstall() {
    pluginDatabaseManager.uninstall(this)
}
```

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–∏
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤**: `db/daos/`, `db/impl/`, `db/models/`, `db/migrations/`.
- **–ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏**: `@DBEntity` (–º–æ–¥–µ–ª–∏), `@Migration` (–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è), `@Dao` (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏).
- **–°–æ–≥–ª–∞—à–µ–Ω–∏–µ –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏**: –ò–º–µ–Ω–∞ **DAO** –∏ **Model** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ—Ö–æ–∂–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `AnnouncementModel` –∏ `AnnouncementDao`).
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: –†–∞—Å—à–∏—Ä—è–π—Ç–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã Dao –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –∫–ª–∞—Å—Å –º–æ–¥–µ–ª–∏. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–æ–≥–∏–∫–∞ `uninstall` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞.

## üõ£Ô∏è API –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: –ø–∞–∫–µ—Ç `routes/`.
- **–¢–∏–ø—ã**: `PanelApi` (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä), `LoggedInApi` (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏).
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**:
    -   –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã.
    -   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—É—Ç–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ `:id`.
    -   –£–∫–∞–∑—ã–≤–∞–π—Ç–µ `required body` –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ö–µ–º—ã.
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `authProvider` –∏–∑ `applicationContext`.
- **–ñ—É—Ä–Ω–∞–ª—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**: –í—Å–µ API –ü–∞–Ω–µ–ª–∏ **–¥–æ–ª–∂–Ω—ã** –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∂—É—Ä–Ω–∞–ª—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ (`com.panomc.platform.error`). –û–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ `error/`, —Ä–∞—Å—à–∏—Ä—è—è `com.panomc.platform.model.Error`.

## üîê –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è**: –û–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –≤ –ø–∞–∫–µ—Ç–µ `permission/`, —Ä–∞—Å—à–∏—Ä—è—è `PanelPermission` —Å `@PermissionDefinition`.
    -   **–ò–∫–æ–Ω–∫–∞**: –ü–µ—Ä–µ–¥–∞–π—Ç–µ –∏–º—è –∏–∫–æ–Ω–∫–∏ FontAwesome –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `PanelPermission` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `PanelPermission("fa-question-circle")`).
    -   **–£–∑–µ–ª**: ID —É–∑–ª–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∏–º–µ–Ω–∏ –∫–ª–∞—Å—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ManageFAQPermission` -> `MANAGE_FAQ`).

**–ü—Ä–∏–º–µ—Ä –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:**
::: code-group
```kotlin [Kotlin]
@PermissionDefinition
class ManageFAQPermission : PanelPermission("fa-question-circle")
```

```java [Java]
@PermissionDefinition
public class ManageFAQPermission extends PanelPermission {
    public ManageFAQPermission() {
        super("fa-question-circle");
    }
}
```
:::
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `PluginConfigManager`.
    -   –•—Ä–∞–Ω–∏—Ç–µ –æ–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–ª–∞—Å—Å–∞—Ö **Config**.
    -   **–°–Ω–∞—á–∞–ª–∞ Enum**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Enum –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–∏–ø–æ–≤.
